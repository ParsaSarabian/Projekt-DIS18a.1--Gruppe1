{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>1287</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>1882</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2105</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>27773</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>34150</td>\n",
       "      <td>3.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>3</td>\n",
       "      <td>45517</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>3</td>\n",
       "      <td>45722</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>3</td>\n",
       "      <td>46578</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3</td>\n",
       "      <td>48774</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3</td>\n",
       "      <td>50872</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId  rating\n",
       "0       2     1287     5.0\n",
       "1       3     1882     2.0\n",
       "2       3     2105     3.0\n",
       "3       3    27773     5.0\n",
       "4       3    34150     3.5\n",
       "5       3    45517     4.0\n",
       "6       3    45722     4.0\n",
       "7       3    46578     4.0\n",
       "8       3    48774     4.0\n",
       "9       3    50872     4.0"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np \n",
    "import pandas as pd\n",
    "data = pd.read_csv('Unsere_Ratings.csv')\n",
    "data.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "movies_titles_genre = pd.read_csv('Unsere_Datei_movieID.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>Title</th>\n",
       "      <th>Genre</th>\n",
       "      <th>Director</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>112852</td>\n",
       "      <td>Guardians of the Galaxy</td>\n",
       "      <td>Action</td>\n",
       "      <td>James Gunn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>94864</td>\n",
       "      <td>Prometheus</td>\n",
       "      <td>Adventure</td>\n",
       "      <td>Ridley Scott</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>166534</td>\n",
       "      <td>Split</td>\n",
       "      <td>Horror</td>\n",
       "      <td>M. Night Shyamalan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>155923</td>\n",
       "      <td>Sing</td>\n",
       "      <td>Animation</td>\n",
       "      <td>Christophe Lourdelet</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>135536</td>\n",
       "      <td>Suicide Squad</td>\n",
       "      <td>Action</td>\n",
       "      <td>David Ayer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>166918</td>\n",
       "      <td>The Great Wall</td>\n",
       "      <td>Action</td>\n",
       "      <td>Yimou Zhang</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>164909</td>\n",
       "      <td>La La Land</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>Damien Chazelle</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>171881</td>\n",
       "      <td>Mindhorn</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>Sean Foley</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>169900</td>\n",
       "      <td>The Lost City of Z</td>\n",
       "      <td>Action</td>\n",
       "      <td>James Gray</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>65567</td>\n",
       "      <td>Passengers</td>\n",
       "      <td>Adventure</td>\n",
       "      <td>Morten Tyldum</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId                    Title      Genre              Director\n",
       "0   112852  Guardians of the Galaxy     Action            James Gunn\n",
       "1    94864               Prometheus  Adventure          Ridley Scott\n",
       "2   166534                    Split     Horror    M. Night Shyamalan\n",
       "3   155923                     Sing  Animation  Christophe Lourdelet\n",
       "4   135536            Suicide Squad     Action            David Ayer\n",
       "5   166918           The Great Wall     Action           Yimou Zhang\n",
       "6   164909               La La Land     Comedy       Damien Chazelle\n",
       "7   171881                 Mindhorn     Comedy            Sean Foley\n",
       "8   169900       The Lost City of Z     Action            James Gray\n",
       "9    65567               Passengers  Adventure         Morten Tyldum"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies_titles_genre.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>Title</th>\n",
       "      <th>Genre</th>\n",
       "      <th>Director</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>1287</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Ben-Hur</td>\n",
       "      <td>Action</td>\n",
       "      <td>Timur Bekmambetov</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>1882</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Godzilla</td>\n",
       "      <td>Action</td>\n",
       "      <td>Gareth Edwards</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2105</td>\n",
       "      <td>3.0</td>\n",
       "      <td>Tron</td>\n",
       "      <td>Action</td>\n",
       "      <td>Joseph Kosinski</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>27773</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Old Boy</td>\n",
       "      <td>Action</td>\n",
       "      <td>Spike Lee</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>34150</td>\n",
       "      <td>3.5</td>\n",
       "      <td>Fantastic Four</td>\n",
       "      <td>Action</td>\n",
       "      <td>Josh Trank</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>3</td>\n",
       "      <td>45517</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Cars</td>\n",
       "      <td>Animation</td>\n",
       "      <td>John Lasseter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>3</td>\n",
       "      <td>45722</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Pirates of the Caribbean: Dead Man's Chest</td>\n",
       "      <td>Action</td>\n",
       "      <td>Gore Verbinski</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>3</td>\n",
       "      <td>46578</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Little Miss Sunshine</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>Jonathan Dayton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3</td>\n",
       "      <td>48774</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Children of Men</td>\n",
       "      <td>Drama</td>\n",
       "      <td>Alfonso Cuarón</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3</td>\n",
       "      <td>50872</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Ratatouille</td>\n",
       "      <td>Animation</td>\n",
       "      <td>Brad Bird</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId  rating                                       Title  \\\n",
       "0       2     1287     5.0                                     Ben-Hur   \n",
       "1       3     1882     2.0                                    Godzilla   \n",
       "2       3     2105     3.0                                        Tron   \n",
       "3       3    27773     5.0                                     Old Boy   \n",
       "4       3    34150     3.5                              Fantastic Four   \n",
       "5       3    45517     4.0                                        Cars   \n",
       "6       3    45722     4.0  Pirates of the Caribbean: Dead Man's Chest   \n",
       "7       3    46578     4.0                        Little Miss Sunshine   \n",
       "8       3    48774     4.0                             Children of Men   \n",
       "9       3    50872     4.0                                 Ratatouille   \n",
       "\n",
       "       Genre           Director  \n",
       "0     Action  Timur Bekmambetov  \n",
       "1     Action     Gareth Edwards  \n",
       "2     Action    Joseph Kosinski  \n",
       "3     Action          Spike Lee  \n",
       "4     Action         Josh Trank  \n",
       "5  Animation      John Lasseter  \n",
       "6     Action     Gore Verbinski  \n",
       "7     Comedy    Jonathan Dayton  \n",
       "8      Drama     Alfonso Cuarón  \n",
       "9  Animation          Brad Bird  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = data.merge(movies_titles_genre, on='movieId', how='left')\n",
    "data.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Title</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>(500) Days of Summer</th>\n",
       "      <td>3.772921</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10 Cloverfield Lane</th>\n",
       "      <td>3.811644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12 Years a Slave</th>\n",
       "      <td>3.885965</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13 Hours</th>\n",
       "      <td>4.181818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2012</th>\n",
       "      <td>2.744635</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20th Century Women</th>\n",
       "      <td>3.375000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21 Jump Street</th>\n",
       "      <td>3.667279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22 Jump Street</th>\n",
       "      <td>3.546012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3 Idiots</th>\n",
       "      <td>3.925926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>3.490053</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        rating\n",
       "Title                         \n",
       "(500) Days of Summer  3.772921\n",
       "10 Cloverfield Lane   3.811644\n",
       "12 Years a Slave      3.885965\n",
       "13 Hours              4.181818\n",
       "2012                  2.744635\n",
       "20th Century Women    3.375000\n",
       "21 Jump Street        3.667279\n",
       "22 Jump Street        3.546012\n",
       "3 Idiots              3.925926\n",
       "300                   3.490053"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Average_ratings = pd.DataFrame(data.groupby('Title')['rating'].mean())\n",
    "Average_ratings.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rating</th>\n",
       "      <th>Total Ratings</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Title</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>(500) Days of Summer</th>\n",
       "      <td>3.772921</td>\n",
       "      <td>469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10 Cloverfield Lane</th>\n",
       "      <td>3.811644</td>\n",
       "      <td>146</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12 Years a Slave</th>\n",
       "      <td>3.885965</td>\n",
       "      <td>228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13 Hours</th>\n",
       "      <td>4.181818</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2012</th>\n",
       "      <td>2.744635</td>\n",
       "      <td>233</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20th Century Women</th>\n",
       "      <td>3.375000</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21 Jump Street</th>\n",
       "      <td>3.667279</td>\n",
       "      <td>272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22 Jump Street</th>\n",
       "      <td>3.546012</td>\n",
       "      <td>163</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3 Idiots</th>\n",
       "      <td>3.925926</td>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>3.490053</td>\n",
       "      <td>754</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        rating  Total Ratings\n",
       "Title                                        \n",
       "(500) Days of Summer  3.772921            469\n",
       "10 Cloverfield Lane   3.811644            146\n",
       "12 Years a Slave      3.885965            228\n",
       "13 Hours              4.181818             33\n",
       "2012                  2.744635            233\n",
       "20th Century Women    3.375000              8\n",
       "21 Jump Street        3.667279            272\n",
       "22 Jump Street        3.546012            163\n",
       "3 Idiots              3.925926             54\n",
       "300                   3.490053            754"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Average_ratings['Total Ratings'] = pd.DataFrame(data.groupby('Title')['rating'].count())\n",
    "Average_ratings.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>(500) Days of Summer</th>\n",
       "      <th>10 Cloverfield Lane</th>\n",
       "      <th>12 Years a Slave</th>\n",
       "      <th>13 Hours</th>\n",
       "      <th>2012</th>\n",
       "      <th>20th Century Women</th>\n",
       "      <th>21 Jump Street</th>\n",
       "      <th>22 Jump Street</th>\n",
       "      <th>3 Idiots</th>\n",
       "      <th>300</th>\n",
       "      <th>...</th>\n",
       "      <th>Wreck-It Ralph</th>\n",
       "      <th>X-Men Origins: Wolverine</th>\n",
       "      <th>X-Men: Apocalypse</th>\n",
       "      <th>X-Men: Days of Future Past</th>\n",
       "      <th>Youth</th>\n",
       "      <th>Zero Dark Thirty</th>\n",
       "      <th>Zodiac</th>\n",
       "      <th>Zombieland</th>\n",
       "      <th>Zoolander 2</th>\n",
       "      <th>Zootopia</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>userId</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>3.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 458 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title   (500) Days of Summer  10 Cloverfield Lane  12 Years a Slave  13 Hours  \\\n",
       "userId                                                                          \n",
       "2                        NaN                  NaN               NaN       NaN   \n",
       "3                        NaN                  NaN               NaN       NaN   \n",
       "4                        NaN                  NaN               NaN       NaN   \n",
       "8                        NaN                  NaN               NaN       NaN   \n",
       "9                        NaN                  NaN               NaN       NaN   \n",
       "12                       3.0                  NaN               NaN       NaN   \n",
       "13                       NaN                  NaN               NaN       NaN   \n",
       "14                       4.0                  NaN               NaN       NaN   \n",
       "16                       NaN                  NaN               NaN       NaN   \n",
       "17                       NaN                  NaN               NaN       NaN   \n",
       "\n",
       "Title   2012  20th Century Women  21 Jump Street  22 Jump Street  3 Idiots  \\\n",
       "userId                                                                       \n",
       "2        NaN                 NaN             NaN             NaN       NaN   \n",
       "3        2.5                 NaN             NaN             3.0       NaN   \n",
       "4        NaN                 NaN             4.0             4.0       NaN   \n",
       "8        NaN                 NaN             NaN             NaN       NaN   \n",
       "9        NaN                 NaN             NaN             NaN       NaN   \n",
       "12       NaN                 NaN             NaN             NaN       NaN   \n",
       "13       2.0                 NaN             NaN             NaN       NaN   \n",
       "14       NaN                 NaN             NaN             NaN       NaN   \n",
       "16       NaN                 NaN             NaN             NaN       4.0   \n",
       "17       NaN                 NaN             NaN             NaN       NaN   \n",
       "\n",
       "Title   300  ...  Wreck-It Ralph  X-Men Origins: Wolverine  X-Men: Apocalypse  \\\n",
       "userId       ...                                                                \n",
       "2       NaN  ...             NaN                       NaN                NaN   \n",
       "3       4.0  ...             NaN                       4.0                3.5   \n",
       "4       NaN  ...             3.5                       NaN                NaN   \n",
       "8       NaN  ...             NaN                       NaN                NaN   \n",
       "9       NaN  ...             NaN                       NaN                NaN   \n",
       "12      NaN  ...             NaN                       NaN                NaN   \n",
       "13      4.0  ...             NaN                       3.0                NaN   \n",
       "14      NaN  ...             NaN                       NaN                NaN   \n",
       "16      NaN  ...             NaN                       NaN                NaN   \n",
       "17      2.5  ...             NaN                       NaN                NaN   \n",
       "\n",
       "Title   X-Men: Days of Future Past  Youth  Zero Dark Thirty  Zodiac  \\\n",
       "userId                                                                \n",
       "2                              NaN    NaN               NaN     NaN   \n",
       "3                              4.0    NaN               NaN     NaN   \n",
       "4                              NaN    NaN               NaN     NaN   \n",
       "8                              NaN    NaN               NaN     NaN   \n",
       "9                              NaN    NaN               NaN     NaN   \n",
       "12                             NaN    NaN               NaN     NaN   \n",
       "13                             NaN    NaN               NaN     NaN   \n",
       "14                             NaN    NaN               NaN     NaN   \n",
       "16                             NaN    NaN               NaN     NaN   \n",
       "17                             NaN    NaN               NaN     NaN   \n",
       "\n",
       "Title   Zombieland  Zoolander 2  Zootopia  \n",
       "userId                                     \n",
       "2              NaN          NaN       NaN  \n",
       "3              4.0          NaN       NaN  \n",
       "4              NaN          NaN       4.5  \n",
       "8              NaN          NaN       NaN  \n",
       "9              NaN          NaN       NaN  \n",
       "12             NaN          NaN       NaN  \n",
       "13             4.0          NaN       NaN  \n",
       "14             NaN          NaN       NaN  \n",
       "16             NaN          NaN       NaN  \n",
       "17             NaN          NaN       NaN  \n",
       "\n",
       "[10 rows x 458 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movie_user= data.pivot_table(index='userId',columns='Title', values='rating')\n",
    "movie_user.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\fborg\\anaconda3\\lib\\site-packages\\numpy\\lib\\function_base.py:2551: RuntimeWarning: Degrees of freedom <= 0 for slice\n",
      "  c = cov(x, y, rowvar)\n",
      "C:\\Users\\fborg\\anaconda3\\lib\\site-packages\\numpy\\lib\\function_base.py:2480: RuntimeWarning: divide by zero encountered in true_divide\n",
      "  c *= np.true_divide(1, fact)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Title\n",
       "(500) Days of Summer    0.393075\n",
       "10 Cloverfield Lane     0.500168\n",
       "12 Years a Slave        0.303337\n",
       "13 Hours                0.240192\n",
       "2012                    0.259638\n",
       "dtype: float64"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "correlations= movie_user.corrwith(movie_user['21 Jump Street'])\n",
    "correlations.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Correlation</th>\n",
       "      <th>Total Ratings</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Title</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>(500) Days of Summer</th>\n",
       "      <td>0.393075</td>\n",
       "      <td>469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10 Cloverfield Lane</th>\n",
       "      <td>0.500168</td>\n",
       "      <td>146</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12 Years a Slave</th>\n",
       "      <td>0.303337</td>\n",
       "      <td>228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13 Hours</th>\n",
       "      <td>0.240192</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2012</th>\n",
       "      <td>0.259638</td>\n",
       "      <td>233</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      Correlation  Total Ratings\n",
       "Title                                           \n",
       "(500) Days of Summer     0.393075            469\n",
       "10 Cloverfield Lane      0.500168            146\n",
       "12 Years a Slave         0.303337            228\n",
       "13 Hours                 0.240192             33\n",
       "2012                     0.259638            233"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "recommendation = pd.DataFrame(correlations, columns=['Correlation'])\n",
    "recommendation.dropna(inplace=True)\n",
    "recommendation= recommendation.join(Average_ratings['Total Ratings'])\n",
    "recommendation.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [],
   "source": [
    "recc = recommendation[recommendation['Total Ratings']>100].sort_values('Correlation', ascending=False).reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Title</th>\n",
       "      <th>Correlation</th>\n",
       "      <th>Total Ratings</th>\n",
       "      <th>movieId</th>\n",
       "      <th>Genre</th>\n",
       "      <th>Director</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>21 Jump Street</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>272</td>\n",
       "      <td>93510</td>\n",
       "      <td>Action</td>\n",
       "      <td>Phil Lord</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Legend</td>\n",
       "      <td>0.861555</td>\n",
       "      <td>142</td>\n",
       "      <td>2143</td>\n",
       "      <td>Biography</td>\n",
       "      <td>Brian Helgeland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Hairspray</td>\n",
       "      <td>0.812605</td>\n",
       "      <td>132</td>\n",
       "      <td>2926</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>Adam Shankman</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>22 Jump Street</td>\n",
       "      <td>0.801527</td>\n",
       "      <td>163</td>\n",
       "      <td>112138</td>\n",
       "      <td>Action</td>\n",
       "      <td>Phil Lord</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Star Trek Beyond</td>\n",
       "      <td>0.686789</td>\n",
       "      <td>134</td>\n",
       "      <td>135569</td>\n",
       "      <td>Action</td>\n",
       "      <td>Justin Lin</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cloud Atlas</td>\n",
       "      <td>0.644377</td>\n",
       "      <td>228</td>\n",
       "      <td>97752</td>\n",
       "      <td>Drama</td>\n",
       "      <td>Tom Tykwer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>John Carter</td>\n",
       "      <td>0.627786</td>\n",
       "      <td>113</td>\n",
       "      <td>93363</td>\n",
       "      <td>Action</td>\n",
       "      <td>Andrew Stanton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Shooter</td>\n",
       "      <td>0.621254</td>\n",
       "      <td>187</td>\n",
       "      <td>51935</td>\n",
       "      <td>Action</td>\n",
       "      <td>Antoine Fuqua</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Ant-Man</td>\n",
       "      <td>0.615132</td>\n",
       "      <td>276</td>\n",
       "      <td>122900</td>\n",
       "      <td>Action</td>\n",
       "      <td>Peyton Reed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Spectre</td>\n",
       "      <td>0.595807</td>\n",
       "      <td>146</td>\n",
       "      <td>136020</td>\n",
       "      <td>Action</td>\n",
       "      <td>Sam Mendes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Title  Correlation  Total Ratings  movieId      Genre  \\\n",
       "0    21 Jump Street     1.000000            272    93510     Action   \n",
       "1            Legend     0.861555            142     2143  Biography   \n",
       "2         Hairspray     0.812605            132     2926     Comedy   \n",
       "3    22 Jump Street     0.801527            163   112138     Action   \n",
       "4  Star Trek Beyond     0.686789            134   135569     Action   \n",
       "5       Cloud Atlas     0.644377            228    97752      Drama   \n",
       "6       John Carter     0.627786            113    93363     Action   \n",
       "7           Shooter     0.621254            187    51935     Action   \n",
       "8           Ant-Man     0.615132            276   122900     Action   \n",
       "9           Spectre     0.595807            146   136020     Action   \n",
       "\n",
       "          Director  \n",
       "0        Phil Lord  \n",
       "1  Brian Helgeland  \n",
       "2    Adam Shankman  \n",
       "3        Phil Lord  \n",
       "4       Justin Lin  \n",
       "5       Tom Tykwer  \n",
       "6   Andrew Stanton  \n",
       "7    Antoine Fuqua  \n",
       "8      Peyton Reed  \n",
       "9       Sam Mendes  "
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "recc= recc.merge(movies_titles_genre,on='Title',how='left')\n",
    "recc.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
